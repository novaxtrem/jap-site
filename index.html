<!DOCTYPE html>
<!-- saved from url=(0049)https://getbootstrap.com/docs/4.3/examples/album/ -->
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <title>eMercado - Todo lo que busques está aquí</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/album/">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <script src="https://apis.google.com/js/platform.js" async defer></script>

    <style>
        html,
        body {
            height: 100%;
        }
        
        body {
            display: -ms-flexbox;
            display: flex;
            -ms-flex-align: center;
            align-items: center;
            padding-top: 40px;
            padding-bottom: 40px;
            background-color: #f5f5f5;
        }
        
        .signin {
            width: 100%;
            max-width: 330px;
            padding: 15px;
            margin: auto;
        }
    </style>
</head>

<body class="text-center">
    <a id="link"><button>Login with Google</button></a>
    <div id="user-info-wrapper">
        <img width="50" />
        <p></p>
        <p></p>
        <p></p>
    </div>
    <script type="text/javascript">
        const urlParams = new URLSearchParams(window.location.search)
        if (urlParams.get('id')) {
            document.querySelector('#link').style.display = 'none'
            document.querySelector('img').src = urlParams.get('picture')
            document.querySelectorAll('p')[0].innerHTML = `Hi, ${urlParams.get('given_name')}!`
            document.querySelectorAll('p')[1].innerHTML = `Full name: ${urlParams.get('name')}`
            document.querySelectorAll('p')[2].innerHTML = `Email: ${urlParams.get('email')}`
        } else {
            document.querySelector('#user-info-wrapper').style.display = 'none'
        }


        async function getClientId() {
            const redirectUri = 'http://localhost:3000/oauth2callback'
            const scope = 'profile email openid'
            const responseType = 'code'

            const response = await fetch('clientId')
            const json = await response.json()
            document.querySelector('#link').href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${json.clientId}&redirect_uri=${redirectUri}&scope=${scope}&response_type=${responseType}&access_type=offline&include_granted_scopes=true`
        }
        getClientId()
    </script>
    <script src="js/init.js"></script>
    <script src="js/login.js"></script>
</body>

</html>